<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Domanda o Verità</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <link rel="stylesheet" href="style.css?v=8_4_8_p3">
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script src="firebase-config.js?v=8_4_8_p3"></script>
</head>
<body>
  <div id="version-banner">Versione: v8.4.8-patch3 – invito a prova di cache + errori visibili</div>

  <div id="toast" class="toast hidden"></div>

  <main id="app">
    <section class="panel">
      <div class="row space-between">
        <div><strong>Diagnostica</strong> <span id="diagShort" class="muted small"></span></div>
        <button id="toggleDiag" class="secondary smallbtn">Mostra dettagli</button>
      </div>
      <pre id="diagBox" class="small hidden"></pre>
    </section>

    <section id="creatorSection" class="panel">
      <h1>Domanda o Verità</h1>
      <div id="creatorStart">
        <p>Inserisci il tuo nome per creare la partita.</p>
        <input type="text" id="nameInput" placeholder="Il tuo nome">
        <button id="inviteBtn" disabled>Genera invito</button>
        <div id="bindWarn" class="muted small hidden">⚠️ Il pulsante non risponde? Ricarica con <code>Ctrl/Cmd+Shift+R</code>. Se persiste, vedi diagnostica.</div>
      </div>

      <div id="gameLinkWrap" class="hidden">
        <p><strong>Link per l'avversario (da inviare):</strong></p>
        <div class="linkrow">
          <input id="gameLinkOpponent" readonly>
          <button id="copyOpponentBtn">📋 Copia</button>
        </div>
        <p><strong>Il tuo link di gestione (per tornare all'attesa):</strong></p>
        <div class="linkrow">
          <input id="gameLinkHost" readonly>
          <button id="copyHostBtn">📋 Copia</button>
        </div>
        <p id="creatorStatus">In attesa che l'avversario accetti...</p>
        <div class="row">
          <button id="cancelBtn" class="danger">Annulla invito</button>
          <button id="newInviteBtn" class="secondary hidden">Nuovo invito</button>
        </div>
      </div>
    </section>

    <section id="inviteeSection" class="panel hidden">
      <h1>Sei stato invitato a giocare</h1>
      <p id="player1Info"></p>
      <input type="text" id="nameInput2" placeholder="Il tuo nome">
      <div class="row">
        <button id="acceptBtn" disabled>Accetta invito</button>
        <button id="rejectBtn" class="secondary">Rifiuta</button>
      </div>
      <p id="inviteeStatus"></p>
    </section>
  </main>

  <script src="script-v848-patch3.js?v=8_4_8_p3"></script>
</body>
</html>
